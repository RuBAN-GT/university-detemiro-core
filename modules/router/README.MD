# Роутер

## Информация

* Код: *router*
* Версия: *1.0*
* Авторы: *DetemiroTM*

## Требования

* Модуль *pages*.

## Описание

Данный модуль предоставляет возможность определения страниц по URL-параметрам или значению URL-строки (т.е. возможна организация ЧПУ-ссылок) с помощью JSON-схем.
А тажке данный модуль способен генерироват ссылки.

## Сервисы

* *router* - сервис, содержащий объект класса *router*.

## Экшены

* *system.mode.page* - экшен вызывает метод *show* у текующей страницы, если она существует.

## Конфигурация

Данный модуль использует следующую конфигурацию с префиксом `router.`.

Параметр  | Тип          | Значение по-умолчанию | Описание
--------- | ------------ | --------------------- | ----------------------------------------------------------------------------
page      | строка       | index                 | Код страницы из сервиса *pages*, соотвествующей главной странице приложения
ssl       | bool         | по вызову через https | Использование протокола https при генерации ссылок
hosts     | array/string | текущий хост          | Возможные хосты, по котором будут определяться страницы
url       | string       | по текущему хосту     | Основной URL для ссылок
preferred | array/string |                       | Предпочитаемые схемы для генерации ссылок

**Пример конфигурации:**

~~~~json
"router.hosts": "detemiro.org,www.detemiro.org",
"router.url"  : "detemiro.org",
"router.page"  : "index",
"router.ssl"  : true
~~~~

## Схемы

Для определения специфических URL-строк или URL-параметров, влияющих на выбранную используются **схемы**. 

Такие схемы размещаются в разделах подгрузок (например, в директории *__externals*) в виде файлов *router.json*.  
Файл должен содержать объекты в массиве (или один объект) со следующей структурой:

* Ключом является код страницы из сервиса *pages*.
* Значением ключа является часть URL-строки после значения *router()->url*.
* Переменные (параметры) этой строки выделяются в {$ключ}.

**Примеры:**

~~~~json
{
    "entry": {
        "common"    : "entry?id={$id}",
        "permalink" : "entry/{$code}"
    }
}
~~~~

Если используется ссылка вида http://site.ru/entry?id=1 или http://site.ru/entry/pageCode, то будет определена страница с кодом *entry*,  
и *router()->args* будет содержать ассоциативный массив вида: `id => 1` или `code => pageCode`, в зависимости от используемого URL.